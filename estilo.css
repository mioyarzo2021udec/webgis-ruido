/* ========================================================= */
/* VARIABLES GLOBALES — control de altura del header */
/* ========================================================= */

:root {
    --header-height: 80px; /* será actualizado dinámicamente por JS */
    color-scheme: light;   /* forzar modo claro */
}

/* ========================================================= */
/* ESTILO GENERAL */
/* ========================================================= */

body {
    margin: 0;
    font-family: Arial, sans-serif;
    height: 100vh;
    display: flex;
    flex-direction: column;
    background: #ffffff !important;
    color: #111 !important;
}

/* Fila principal: panel izquierdo + mapa */
#content-row {
    flex: 1;
    display: flex;
    min-height: 0;
}

/* ========================================================= */
/* HEADER */
/* ========================================================= */

.top-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 6px 14px;
    background-color: #3f1378 !important;   /* nuevo morado */
    border-bottom: 1px solid #2c0f5c;
    gap: 12px;
    position: relative;
    z-index: 1000;
    min-height: var(--header-height);
    color: white;
}

/* Bloque título + texto descriptivo */
.header-title-block {
    display: flex;
    flex-direction: column;
    max-width: 45%;
}

.top-bar h2 {
    margin: 0;
    font-size: 20px;
    flex-shrink: 0;
    color: white;
}

.header-subtext {
    font-size: 13px;
    line-height: 1.3;
    margin: 4px 0 0 0;
    color: #e6e6e6;
}

/* Contenedor de controles del header */
.control-row {
    display: flex;
    gap: 14px;
    align-items: flex-end;
    justify-content: center;
    flex-grow: 1;
}

/* Grupo de controles (hexbin, modo color, base map) */
.control-group {
    display: flex;
    flex-direction: column;
    min-width: 130px;
}

/* Mover selects ligeramente a la derecha */
#colorMode,
#basemapSelect {
    margin-left: 6px;   /* movimiento suave */
}

.control-group label {
    font-size: 12px;
    font-weight: bold;
    margin-bottom: 4px;
    color: white;
}

/* Selects con buena altura/grosor */
.control-group select {
    padding: 4px 8px;
    font-size: 14px;
    height: 32px;
    border-radius: 5px;
}

/* Checkbox hexbin un poco más grande */
#hexbinToggle {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

/* Checkbox azul al estar seleccionado */
input[type="checkbox"]:checked {
    accent-color: #4959de;
}

/* Botones principales del header */
.top-bar button {
    padding: 7px 14px;
    font-size: 15px;
    border: none;
    background-color: #4959de;  /* nuevo color */
    color: white;
    border-radius: 6px;
    cursor: pointer;
}

.top-bar button:hover {
    background-color: #323fab; 
}

/* Notas bajo los botones (optimizado para PC / celulares) */
.btn-note {
    display: block;
    font-size: 12px;
    font-style: italic;
    color: #e3e3e3;
    line-height: 1.2;
    margin-top: 2px;
}

/* ========================================================= */
/* PANEL LATERAL IZQUIERDO */
/* ========================================================= */

#legend-panel {
    width: 300px;                 /* un poco más ancho que 260px */
    border-right: 1px solid #ccc;
    padding: 12px;
    background: #ffffff !important;
    overflow-y: auto;
    color: #111 !important;
}

/* ========================================================= */
/* LEYENDA (AZUL OSCURO EXTERIOR + BLANCO INTERIOR) */
/* ========================================================= */

.legend {
    background: #2c3791;          /* azul oscuro exterior */
    padding: 12px;
    border-radius: 6px;
    border: 1px solid #2c3791;
    color: white;
    margin-bottom: 22px;
}

.legend-title {
    margin: 0 0 8px 0;
    font-size: 16px;
    font-weight: bold;
    color: white;
}

/* Recuadro blanco único INTERIOR de la leyenda */
#legend-content {
    background: #ffffff;
    color: #111;
    border-radius: 6px;
    border: 1px solid #ddd;
    padding: 12px;
    font-size: 13px;
}

/* ------ MUY IMPORTANTE ------
   El script genera otra <div class="legend"> dentro de #legend-content.
   Aquí LA "APAGAMOS" para que NO se vea otro recuadro azul adentro.
-------------------------------- */
#legend-content .legend {
    background: transparent;
    border: none;
    padding: 0;
    margin: 0;
    color: inherit;
}

/* Título interno (Niveles de ruido / Molestia percibida) */
#legend-content h4 {
    margin: 4px 0 6px 0;
    font-size: 13.5px;
    color: #111;
}

#legend-content .legend-row {
    margin-bottom: 6px;   /* antes 4px */
}

.legend-example {
    margin-bottom: 12px; /* un poquito más */
}

/* Fila color + texto */
.legend-row {
    display: flex;
    align-items: center;
    margin-bottom: 4px;
    color: #111;
}

.legend-color {
    width: 20px;
    height: 12px;
    border: 1px solid #777;
    margin-right: 8px;
}

/* Ejemplo debajo de cada rango */
.legend-example {
    margin-left: 28px;
    margin-top: 1px;
    margin-bottom: 8px;
    font-size: 12px;
    color: #555;
    font-style: italic;
}

/* Nota final OMS / escala subjetiva */
.legend-footnote {
    text-align: center;
    margin-top: 14px;
    font-size: 12px;
    color: #555;
    font-style: italic;
}

/* ========================================================= */
/* FILTROS Y RESUMEN — CAJAS AZULES CON INTERIOR BLANCO */
/* ========================================================= */

.panel-box {
    border: 1px solid #2c3791;
    border-radius: 6px;
    padding: 10px 12px;
    margin-top: 22px;
    margin-bottom: 22px;
    background: #2c3791;          /* azul oscuro exterior */
    color: white;
}

#filters-panel h3,
#summary-panel h3 {
    margin: 0 0 8px 0;
    font-size: 15px;
    font-weight: bold;
}

#filters-panel .panel-inner,
#filters-panel input,
#filters-panel label,
#filters-panel h4 {
    font-size: 13px !important;
}


/* Caja interna blanca para filtros y resumen */
.panel-inner {
    background: #ffffff;
    color: #111;
    border-radius: 6px;
    padding: 10px 12px;
    border: 1px solid #dddddd;
    margin-top: 6px;
}

/* ========================================================= */
/* FILTROS */
/* ========================================================= */

.filter-section {
    margin-bottom: 16px;
    padding-bottom: 10px;
    border-bottom: 1px dashed #ccc;
}

.filter-section:last-child {
    margin-bottom: 10px;
    border-bottom: none;
    padding-bottom: 0;
}

.filter-section h4 {
    font-size: 14px;
    margin: 6px 0 8px 0;
    font-weight: bold;
}

/* Inputs de filtros */
#filters-panel input {
    width: 100%;
    padding: 6px;
    margin-top: 3px;
    font-size: 13px;
    border: 1px solid #bbb;
    border-radius: 4px;
}

/* Checkboxes de fuentes con texto alineado y poco espacio entre líneas */
#filters-panel label {
    font-size: 13px;
    display: flex;
    align-items: center;
    gap: 6px;
    margin-top: 4px;      /* un poco menos para no quedar tan separado */
}

/* Tamaño checkbox fuentes (coincide con header) */
#filters-panel input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
}

/* Botones de filtros */
.filter-btn {
    width: 100%;
    padding: 9px;
    margin-top: 6px;
    background: #3a4acf;  /* azul claro */
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 13.5px;
}

.filter-btn:hover:not(.reset) {
    background: #323fab;  /* azul medio */
}

.filter-btn.reset {
    background: #777;
}

/* ========================================================= */
/* RESUMEN DE FILTRADOS */
/* ========================================================= */

#summary-list {
    padding-left: 18px;
    margin: 0;
    font-size: 13px;
    color: #111;
}

/* Separación entre ítems del resumen (suave, no exagerado) */
#summary-list li {
    margin-bottom: 8px;
    line-height: 1.42;
}

/* Ajuste extra de padding dentro del panel de resumen */
#summary-panel .panel-inner {
    padding-top: 8px;
    padding-bottom: 8px;
}

/* Ajuste de ancho de inputs */
#filters-panel input[type="time"],
#filters-panel input[type="date"],
#filters-panel input[type="number"] {
    width: 5cm;              /* nuevo ancho exacto */
    max-width: 100%;
    margin-left: auto;
    margin-right: auto;      /* centrado */
    display: block;
}


/* ========================================================= */
/* MAPA */
/* ========================================================= */

#map {
    flex: 1;
    height: 100%;
    min-width: 0;
    z-index: 1;
}

/* ========================================================= */
/* PANELES LATERALES DERECHA (INFO / FORM / DESCARGA) */
/* ========================================================= */

#info-panel,
#form-panel,
#download-panel {
    position: fixed;
    top: var(--header-height);
    right: 0;
    height: calc(100vh - var(--header-height));
    background-color: #ffffff !important;
    border-left: 1px solid #ccc;
    display: none;             /* se muestran con .open */
    flex-direction: column;
    overflow: hidden;
    z-index: 1100;
}

/* Anchos diferenciados como en la versión funcional original */
#info-panel {
    width: 22%;
    max-width: 300px;
    z-index: 1300 !important;
}

#download-panel {
    width: 28%;
    max-width: 330px;
    z-index: 1200 !important;
}

#form-panel {
    width: 32%;
    max-width: 380px;
    z-index: 1100 !important;
}

/* Mostrar panel cuando tiene la clase .open */
#info-panel.open,
#form-panel.open,
#download-panel.open {
    display: flex;
}

/* Encabezados de los paneles derecho */
.info-header,
.form-panel-header,
.download-panel-header {
    padding: 10px 12px;
    background: #323fab;      /* azul medio */
    color: white;
    border-bottom: 1px solid #2c3791;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
}

.info-header h3,
.form-panel-header h3,
.download-panel-header h3 {
    margin: 0;
    font-size: 15px;
}

/* Botones de cierre dentro de los encabezados */
.info-header button,
.form-panel-header button,
.download-panel-header button {
    background: transparent;
    border: none;
    color: white;
    font-size: 18px;
    cursor: pointer;
}

.info-header button:hover,
.form-panel-header button:hover,
.download-panel-header button:hover {
    background: rgba(255, 255, 255, 0.15);
    border-radius: 4px;
}

/* Contenidos scrolleables */
#info-content {
    flex-grow: 1;
    overflow-y: auto;
    padding: 16px;
    padding-top: 18px;   /* separación extra del borde superior */
    font-size: 14px;
    line-height: 1.4;
}

#download-content {
    flex-grow: 1;
    overflow-y: auto;
    padding: 12px;
    font-size: 14px;
}

#kobo-frame {
    flex-grow: 1;
    width: 100%;
    height: 100%;
    border: none;
}

/* ========================================================= */
/* PANEL DE DESCARGA (BOTONES AZUL CLARO) */
/* ========================================================= */

#download-panel.open {
    display: flex;
}

/* Caja de información previa a la descarga */
.download-info-box {
    background: #fafafa;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 10px 12px;
    margin-bottom: 14px;
    font-size: 13px;
    color: #444;
    line-height: 1.35;
}

/* Botones de acción dentro de descarga */
.download-action {
    width: 100%;
    padding: 10px;
    margin-bottom: 12px;
    background: #4959de;   /* nuevo color */
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 14px;
}

.download-action:hover {
    background: #323fab;
}

/* ========================================================= */
/* HEXBIN LABEL */
/* ========================================================= */

.hexbin-label {
    font-size: 11px;
    font-weight: bold;
    color: #000;
    text-shadow: 0 0 3px white;
    pointer-events: none;
}

/* ========================================================= */
/*                     AJUSTES PARA PC                       */
/* ========================================================= */

@media (min-width: 601px) {

    /* Texto bajo el título más ancho */
    .header-subtext {
        max-width: 420px !important;
        margin-left: 0 !important;
        text-align: justify !important;
    }

    /* Selectores alineados con Hexbin */
    #colorMode,
    #basemapSelect {
        margin-left: 0 !important;
    }

    .control-row {
        justify-content: flex-start !important;
        gap: 18px !important;
    }
}


/* ========================================================= */
/*                     AJUSTES PARA MÓVIL                    */
/* ========================================================= */

@media (max-width: 600px) {

    html, body {
        overflow-x: hidden !important;
    }

    /* ---------- HEADER COMO GRID ---------- */
    .top-bar {
        display: grid !important;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: auto auto auto;
        width: 100% !important;
        padding: 10px 6px !important;
        row-gap: 8px !important;
        justify-items: center !important;
    }

    /* ---------- TÍTULO ---------- */
    .header-title-block {
        grid-column: 1 / span 2;
        text-align: center !important;
        max-width: 92% !important;
    }

    .header-subtext {
        font-size: 11px !important;
        max-width: 92% !important;
        text-align: justify !important;
        margin: 0 auto !important;
    }

    /* ---------- CONTROLES ---------- */
    .control-row {
        grid-column: 1 / span 2;
        display: flex !important;
        justify-content: space-between !important;
        width: 95% !important;
        gap: 6px !important;
    }

    .control-group { min-width: 0 !important; }

    /* Hexbin centrado */
    .control-group:nth-child(1) {
        flex: 0.45 !important;
        margin-left: 8px !important; /* 7–8 mm desde borde, como pediste */
        text-align: center !important;
    }

    /* Selects más cortos */
    .control-group select {
        max-width: 130px !important;
        width: 100% !important;
        font-size: 12px !important;
    }

    /* Visualización temática */
    .control-group:nth-child(2) {
        flex: 1.2 !important;
    }

    /* Mapa base */
    .control-group:nth-child(3) {
        flex: 1.2 !important;
        margin-right: 4px !important;
    }

    /* ---------- BOTONES ---------- */
    #open-download-btn,
    #open-form-btn {
        grid-row: 3;
        width: 88% !important;
        max-width: 220px !important;
        padding: 7px 4px !important;
        font-size: 12px !important;
    }

    #open-download-btn { grid-column: 1; }
    #open-form-btn     { grid-column: 2; }

    /* ---------- MAPA (GARANTIZADO) ---------- */
    #map {
        grid-column: 1 / span 2;
        display: block !important;
        width: 100% !important;
        height: calc(100vh - 300px) !important;
        min-height: 320px !important;
        margin-top: 6px !important;
    }

    /* Panel debajo en móvil */
    #legend-panel {
        grid-column: 1 / span 2;
        width: 100% !important;
        padding: 10px !important;
    }

    .panel-box,
    .panel-inner {
        width: 100% !important;
        box-sizing: border-box !important;
    }
}
